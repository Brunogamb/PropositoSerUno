---
import { Image } from 'astro:assets';
import logo from '../assets/img/logo.png';
---

<header>
    <div class="top-nav">
        <a href="/PropositoSerUno/" class="header-logo"><Image src={logo} alt="Logo Propósito Ser Uno" class="logo" loading="eager"/></a>

        <nav class="services-nav">
            <ul>
                <li><a href="/PropositoSerUno/membresia">Membresía</a></li>
                <li><a href="/PropositoSerUno/programa">Programa</a></li>
                <li><a href="/PropositoSerUno/comunidad">Comunidad</a></li>
                <li><a href="/PropositoSerUno/resultados">Resultados</a></li>
                <li><a href="/PropositoSerUno/fundadores">Fundadores</a></li>

                <li class="hidden-buttons" style="display:none;"><a href="/PropositoSerUno/terapias">Terapias</a></li>
                <li class="hidden-buttons" style="display:none;"><a href="/PropositoSerUno/material">Material</a></li>
                <li class="hidden-buttons" style="display:none;"><a href="/PropositoSerUno/talleres">Talleres</a></li>
            </ul>
        </nav>

    <a id="acceso-btn" href="/PropositoSerUno/acceso" class="acceso">Acceso</a>
    </div>
</header>

<style>
header {
    top: 0;
    left: 0;
    width: 100%;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 80px;
    padding: 0 20px;
}

.top-nav {
    max-width: 1200px;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 32px;
}

.top-nav a {
    font-weight: 500;
    font-size: 16px;
}

#acceso-btn {
    padding: 4px 12px 6px 12px;
    border-radius: 20px;
    transition: all 0.3s ease;
    border: 2px solid #f1f1f1;
}

#acceso-btn:hover {
    background-color: #f1f1f1;
    color: #2c0db3;
    box-shadow: 0 10px 30px rgba(241, 241, 241, 0.12);
}

.header-logo {
    height: 32px;
}

.header-logo img {
    height: 100%;
    width: auto;
}

.services-nav {
    display: flex;
    gap: 32px;
    align-items: center;
    justify-content: center; 
}

.services-nav ul {
    list-style: none;
    display: flex;
    gap: inherit;
}

.services-nav a {
    transition: all 0.3s ease;
}

.services-nav a:not(.hidden-buttons):hover, .acceso:hover {
    text-shadow: 0 0px 2px rgb(255, 255, 255);
}

.hidden-buttons:hover {
    color: #d6674f;
    text-shadow: 0 0px 2px #d6674f;
}
</style>

<script type="module">
const accesoBtn = document.getElementById("acceso-btn");
const headerLinks = document.querySelectorAll(".hidden-buttons");

function updateHeader() {
    const loggedIn = localStorage.getItem("loggedIn") === "true";
    headerLinks.forEach(li => li.style.display = loggedIn ? "list-item" : "none");
    accesoBtn.textContent = loggedIn ? "Cerrar sesión" : "Acceso";
    accesoBtn.href = loggedIn ? "#" : "/PropositoSerUno/acceso";
}

function clearAuthCookies() {
    document.cookie = "loggedIn=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT";
    document.cookie = "userId=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT";
}

accesoBtn.addEventListener("click", (e) => {
    if (localStorage.getItem("loggedIn") === "true") {
        e.preventDefault();
        
        localStorage.removeItem("loggedIn");
        localStorage.removeItem("userId");
        
        clearAuthCookies();
        
        updateHeader();
        
        window.location.href = "/PropositoSerUno/";
    }
});

updateHeader();
</script>